!function(f){"use strict";var h="shoppingActions";f(function(){var e,t,o,a,n,i,s,c,r,d,l,u=f.shop();function p(){f(".wiki").each(function(){var e=f(this);e.popover({content:f(e.data("content-el")).html(),html:!0})})}e=baseUrl+"tmpShoppingSideCard",t=baseUrl+"checkCouponCode",c=f("#main_sidebar__wrapper"),o=f('input[name="coupon_code"]'),a=f("#couponChecker"),n=f("#couponDelete"),i=f("#sh-rc"),a.on("click."+h,function(){(r=f(this)).is(":disabled")||(d=o.val(),""!==f.trim(d)&&u.ajaxRequest({url:t,method:"POST",data:{postedCode:d,cityCode:s}},function(e){var t=JSON.parse(e);u.processAjaxData(t,function(e){t.success&&(c.html(e),o.attr("readonly","readonly"),r.attr("disabled","disabled"),p())})}))}),n.on("click."+h,function(){o.attr("readonly",!1).val(""),a.attr("disabled",!1)}),i.on("change."+h,function(){l=f(this),s=(s=l.find(":selected"))?s.val():l.find("option").first().val(),""!==f.trim(s)&&"-1"!=s&&(u.showLoader=!1,u.ajaxRequest({url:e,method:"POST",data:{cityCode:s}},function(e){var t=JSON.parse(e);u.processAjaxData(t,function(e){t.success&&c.html(e)})},null,function(){u.showLoader=!0,u.isInProgress=!1,u.removeLoader()}))}),p()}),f(function(){var o=baseUrl;f(".cityLoader").on("change."+h,function(){var e,r,t;e=f(this),r=(r=e.data("target-for"))&&f(r)&&f(r).length?f(r):null,"select"===this.nodeName.toLowerCase()&&r&&(t=(t=e.find(":selected"))?t.val():e.find("option").first().val(),f.ajax({url:o+"getCity",method:"POST",data:{postedId:t}}).done(function(e){var t,o,a,n,i,s,c;if((t=JSON.parse(e)).success)for(r.find(".removable-city-option").remove(),n=(o=t.success.msg).length,a=0;a<n;++a)s=o[a].id,c=o[a].name,i="<option value='"+s+"' class='removable-city-option'>"+c+"</option>",r.append(i)}))})})}(jQuery);