!function(h){"use strict";h(function(){function t(){var t,s,d,i,c,u,f=this,l=h.shop(),p="cardActions",a=baseUrl+"fetchCardItems",o=baseUrl+"addToCart",e=baseUrl+"removeFromCart",r=(baseUrl,{}),m='<div class="menu-icon basket-icon dropdown-toggle" id="shoppingCart" data-toggle="dropdown"\n                                     aria-haspopup="true" aria-expanded="false" data-target="basketDropdown">\n                                    <i class="la la-shopping-cart" id="cart"></i>\n                                    <span class="basket-number badge">۰</span>\n                                 </div>';function g(){l.showLoader=!1,l.ajaxRequest({url:a,method:"GET"},function(t){var a=JSON.parse(t);a.success&&a.success.msg?(i.html(a.success.msg[0]),d.text(a.success.msg[1])):l.showMessage("خطا در واکشی سبد خرید!","خطا","error",l.messageIcon.danger)},null,function(){l.isInProgress=!1,l.showLoader=!0,n(),l.removeLoader()})}function n(){var a,n,e,o,r;t.length&&(s.length||(t.prepend(m),s=t.find(".cart-btn"),d=s.find(".count-cart"),h(s).dropdown("destroy").dropdown()),i.length&&(u=h(".add-to-cart-btn"),c=t.find(".remove-from-cart-btn"),u.off("click."+p).on("click."+p,function(t){t.preventDefault(),a=h(this),n=a.attr("data-item-id"),e=a.attr("data-item-quantity"),f.addToCart(n,!1,e)}),c.off("click."+p).on("click."+p,function(t){t.preventDefault(),o=h(this),l.question(null,function(){r=o.attr("data-item-id"),f.removeFromCart(r)})})))}t=h(".basket-container").first(),i=t.find("#basketDropdown"),s=t.find("#shoppingCart"),d=s.find(".basket-number"),f.init=function(){n()},f.addToCart=function(t,a,n){var e;r.add={},t&&(r.add.postedId=t,a&&(r.add.postedColorCode=a),n&&(r.add.quantity=n),e=r.add?r.add:{},l.ajaxRequest({url:o,method:"POST",data:e},function(t){l.processAjaxData(JSON.parse(t),function(){l.isInProgress=!1,g()})}))},f.removeFromCart=function(t,a){var n;r.del={},t&&(r.del.postedId=t,a&&(r.del.postedColorCode=a),n=r.del?r.del:{},l.ajaxRequest({url:e,method:"POST",data:n},function(t){l.processAjaxData(JSON.parse(t),function(){l.isInProgress=!1,"cart"===siteAction&&window.location.reload(),g()})},null,function(){l.isInProgress=!1}))},f.refresh=function(){g()},f.removeAllFromCart=function(){}}h.cart=function(){return new t},h.cart().init()}),h(function(){var t="product_detail_action";h("[data-cart-quantity-for]").off("change."+t).on("change."+t,function(){var t,a,n;n=!!((n=(t=h(this)).data("cart-quantity-for"))&&h(n)&&h(n).length)&&h(n),(a=(a=t.find(":selected"))?a.val():t.find("option").first().val())&&n&&n.attr("data-item-quantity",a)})})}(jQuery);